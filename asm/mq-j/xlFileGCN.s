# xlFileGCN.c
.include "macros.inc"

.section .text, "ax"

.balign 4

# 0x80005DC8 - 0x800061E0

glabel xlFileEvent
/* 002DC8 80005DC8 7C0802A6 */  mflr      r0
/* 002DCC 80005DCC 2C040003 */  cmpwi     r4, 0x3
/* 002DD0 80005DD0 90010004 */  stw       r0, 0x4(r1)
/* 002DD4 80005DD4 9421FFE0 */  stwu      r1, -0x20(r1)
/* 002DD8 80005DD8 93E1001C */  stw       r31, 0x1c(r1)
/* 002DDC 80005DDC 3BE30000 */  addi      r31, r3, 0x0
/* 002DE0 80005DE0 41820058 */  beq       lbl_80005E38
/* 002DE4 80005DE4 40800018 */  bge       lbl_80005DFC
/* 002DE8 80005DE8 2C040002 */  cmpwi     r4, 0x2
/* 002DEC 80005DEC 4080001C */  bge       lbl_80005E08
/* 002DF0 80005DF0 2C040000 */  cmpwi     r4, 0x0
/* 002DF4 80005DF4 4080006C */  bge       lbl_80005E60
/* 002DF8 80005DF8 48000060 */  b         lbl_80005E58
lbl_80005DFC:
/* 002DFC 80005DFC 2C040005 */  cmpwi     r4, 0x5
/* 002E00 80005E00 40800058 */  bge       lbl_80005E58
/* 002E04 80005E04 4800005C */  b         lbl_80005E60
lbl_80005E08:
/* 002E08 80005E08 38000000 */  li        r0, 0x0
/* 002E0C 80005E0C 901F0010 */  stw       r0, 0x10(r31)
/* 002E10 80005E10 3C803000 */  lis       r4, 0x3000
/* 002E14 80005E14 387F0008 */  addi      r3, r31, 0x8
/* 002E18 80005E18 901F0014 */  stw       r0, 0x14(r31)
/* 002E1C 80005E1C 38841024 */  addi      r4, r4, 0x1024
/* 002E20 80005E20 901F0004 */  stw       r0, 0x4(r31)
/* 002E24 80005E24 480012F1 */  bl        xlHeapTake
/* 002E28 80005E28 2C030000 */  cmpwi     r3, 0x0
/* 002E2C 80005E2C 40820034 */  bne       lbl_80005E60
/* 002E30 80005E30 38600000 */  li        r3, 0x0
/* 002E34 80005E34 48000030 */  b         lbl_80005E64
lbl_80005E38:
/* 002E38 80005E38 387F001C */  addi      r3, r31, 0x1c
/* 002E3C 80005E3C 480ABB05 */  bl        DVDClose
/* 002E40 80005E40 387F0008 */  addi      r3, r31, 0x8
/* 002E44 80005E44 480011B5 */  bl        xlHeapFree
/* 002E48 80005E48 2C030000 */  cmpwi     r3, 0x0
/* 002E4C 80005E4C 40820014 */  bne       lbl_80005E60
/* 002E50 80005E50 38600000 */  li        r3, 0x0
/* 002E54 80005E54 48000010 */  b         lbl_80005E64
lbl_80005E58:
/* 002E58 80005E58 38600000 */  li        r3, 0x0
/* 002E5C 80005E5C 48000008 */  b         lbl_80005E64
lbl_80005E60:
/* 002E60 80005E60 38600001 */  li        r3, 0x1
lbl_80005E64:
/* 002E64 80005E64 80010024 */  lwz       r0, 0x24(r1)
/* 002E68 80005E68 83E1001C */  lwz       r31, 0x1c(r1)
/* 002E6C 80005E6C 38210020 */  addi      r1, r1, 0x20
/* 002E70 80005E70 7C0803A6 */  mtlr      r0
/* 002E74 80005E74 4E800020 */  blr

glabel xlFileSetPosition
/* 002E78 80005E78 2C040000 */  cmpwi     r4, 0x0
/* 002E7C 80005E7C 4180001C */  blt       lbl_80005E98
/* 002E80 80005E80 80030010 */  lwz       r0, 0x10(r3)
/* 002E84 80005E84 7C040000 */  cmpw      r4, r0
/* 002E88 80005E88 40800010 */  bge       lbl_80005E98
/* 002E8C 80005E8C 90830014 */  stw       r4, 0x14(r3)
/* 002E90 80005E90 38600001 */  li        r3, 0x1
/* 002E94 80005E94 4E800020 */  blr
lbl_80005E98:
/* 002E98 80005E98 38600000 */  li        r3, 0x0
/* 002E9C 80005E9C 4E800020 */  blr

glabel xlFileGet
/* 002EA0 80005EA0 7C0802A6 */  mflr      r0
/* 002EA4 80005EA4 90010004 */  stw       r0, 0x4(r1)
/* 002EA8 80005EA8 9421FFD0 */  stwu      r1, -0x30(r1)
/* 002EAC 80005EAC BF61001C */  stmw      r27, 0x1c(r1)
/* 002EB0 80005EB0 7C7B1B78 */  mr        r27, r3
/* 002EB4 80005EB4 7CBD2B78 */  mr        r29, r5
/* 002EB8 80005EB8 3B840000 */  addi      r28, r4, 0x0
/* 002EBC 80005EBC 80630014 */  lwz       r3, 0x14(r3)
/* 002EC0 80005EC0 80BB0010 */  lwz       r5, 0x10(r27)
/* 002EC4 80005EC4 7C03EA14 */  add       r0, r3, r29
/* 002EC8 80005EC8 7C002800 */  cmpw      r0, r5
/* 002ECC 80005ECC 40810008 */  ble       lbl_80005ED4
/* 002ED0 80005ED0 7FA32850 */  subf      r29, r3, r5
lbl_80005ED4:
/* 002ED4 80005ED4 2C1D0000 */  cmpwi     r29, 0x0
/* 002ED8 80005ED8 408200AC */  bne       lbl_80005F84
/* 002EDC 80005EDC 3800FFFF */  li        r0, -0x1
/* 002EE0 80005EE0 981C0000 */  stb       r0, 0x0(r28)
/* 002EE4 80005EE4 38600000 */  li        r3, 0x0
/* 002EE8 80005EE8 480000A8 */  b         lbl_80005F90
/* 002EEC 80005EEC 48000098 */  b         lbl_80005F84
lbl_80005EF0:
/* 002EF0 80005EF0 3BDD0000 */  addi      r30, r29, 0x0
/* 002EF4 80005EF4 2C1E1000 */  cmpwi     r30, 0x1000
/* 002EF8 80005EF8 40810008 */  ble       lbl_80005F00
/* 002EFC 80005EFC 3BC01000 */  li        r30, 0x1000
lbl_80005F00:
/* 002F00 80005F00 807B0014 */  lwz       r3, 0x14(r27)
/* 002F04 80005F04 818D88C4 */  lwz       r12, gpfRead@sda21(r0)
/* 002F08 80005F08 547F07BE */  clrlwi    r31, r3, 30
/* 002F0C 80005F0C 381F001F */  addi      r0, r31, 0x1f
/* 002F10 80005F10 7C1E0214 */  add       r0, r30, r0
/* 002F14 80005F14 280C0000 */  cmplwi    r12, 0x0
/* 002F18 80005F18 5466003A */  clrrwi    r6, r3, 2
/* 002F1C 80005F1C 54050034 */  clrrwi    r5, r0, 5
/* 002F20 80005F20 4182001C */  beq       lbl_80005F3C
/* 002F24 80005F24 807B0004 */  lwz       r3, 0x4(r27)
/* 002F28 80005F28 7D8803A6 */  mtlr      r12
/* 002F2C 80005F2C 809B0008 */  lwz       r4, 0x8(r27)
/* 002F30 80005F30 38E00000 */  li        r7, 0x0
/* 002F34 80005F34 4E800021 */  blrl
/* 002F38 80005F38 48000014 */  b         lbl_80005F4C
lbl_80005F3C:
/* 002F3C 80005F3C 807B0004 */  lwz       r3, 0x4(r27)
/* 002F40 80005F40 38E00002 */  li        r7, 0x2
/* 002F44 80005F44 809B0008 */  lwz       r4, 0x8(r27)
/* 002F48 80005F48 480ABD31 */  bl        DVDReadPrio
lbl_80005F4C:
/* 002F4C 80005F4C 801B0008 */  lwz       r0, 0x8(r27)
/* 002F50 80005F50 387C0000 */  addi      r3, r28, 0x0
/* 002F54 80005F54 38BE0000 */  addi      r5, r30, 0x0
/* 002F58 80005F58 7C80FA14 */  add       r4, r0, r31
/* 002F5C 80005F5C 48000AF5 */  bl        xlHeapCopy
/* 002F60 80005F60 2C030000 */  cmpwi     r3, 0x0
/* 002F64 80005F64 4082000C */  bne       lbl_80005F70
/* 002F68 80005F68 38600000 */  li        r3, 0x0
/* 002F6C 80005F6C 48000024 */  b         lbl_80005F90
lbl_80005F70:
/* 002F70 80005F70 801B0014 */  lwz       r0, 0x14(r27)
/* 002F74 80005F74 7F9CF214 */  add       r28, r28, r30
/* 002F78 80005F78 7FBEE850 */  subf      r29, r30, r29
/* 002F7C 80005F7C 7C00F214 */  add       r0, r0, r30
/* 002F80 80005F80 901B0014 */  stw       r0, 0x14(r27)
lbl_80005F84:
/* 002F84 80005F84 2C1D0000 */  cmpwi     r29, 0x0
/* 002F88 80005F88 4082FF68 */  bne       lbl_80005EF0
/* 002F8C 80005F8C 38600001 */  li        r3, 0x1
lbl_80005F90:
/* 002F90 80005F90 BB61001C */  lmw       r27, 0x1c(r1)
/* 002F94 80005F94 80010034 */  lwz       r0, 0x34(r1)
/* 002F98 80005F98 38210030 */  addi      r1, r1, 0x30
/* 002F9C 80005F9C 7C0803A6 */  mtlr      r0
/* 002FA0 80005FA0 4E800020 */  blr

glabel xlFileClose
/* 002FA4 80005FA4 7C0802A6 */  mflr      r0
/* 002FA8 80005FA8 90010004 */  stw       r0, 0x4(r1)
/* 002FAC 80005FAC 9421FFF8 */  stwu      r1, -0x8(r1)
/* 002FB0 80005FB0 48001D3D */  bl        xlObjectFree
/* 002FB4 80005FB4 2C030000 */  cmpwi     r3, 0x0
/* 002FB8 80005FB8 4082000C */  bne       lbl_80005FC4
/* 002FBC 80005FBC 38600000 */  li        r3, 0x0
/* 002FC0 80005FC0 48000008 */  b         lbl_80005FC8
lbl_80005FC4:
/* 002FC4 80005FC4 38600001 */  li        r3, 0x1
lbl_80005FC8:
/* 002FC8 80005FC8 8001000C */  lwz       r0, 0xc(r1)
/* 002FCC 80005FCC 38210008 */  addi      r1, r1, 0x8
/* 002FD0 80005FD0 7C0803A6 */  mtlr      r0
/* 002FD4 80005FD4 4E800020 */  blr

glabel xlFileOpen
/* 002FD8 80005FD8 7C0802A6 */  mflr      r0
/* 002FDC 80005FDC 3CC0800E */  lis       r6, gTypeFile@ha
/* 002FE0 80005FE0 90010004 */  stw       r0, 0x4(r1)
/* 002FE4 80005FE4 3806A3C0 */  addi      r0, r6, gTypeFile@l
/* 002FE8 80005FE8 9421FFD8 */  stwu      r1, -0x28(r1)
/* 002FEC 80005FEC 93E10024 */  stw       r31, 0x24(r1)
/* 002FF0 80005FF0 3BE50000 */  addi      r31, r5, 0x0
/* 002FF4 80005FF4 7C050378 */  mr        r5, r0
/* 002FF8 80005FF8 93C10020 */  stw       r30, 0x20(r1)
/* 002FFC 80005FFC 3BC40000 */  addi      r30, r4, 0x0
/* 003000 80006000 38800000 */  li        r4, 0x0
/* 003004 80006004 93A1001C */  stw       r29, 0x1c(r1)
/* 003008 80006008 3BA30000 */  addi      r29, r3, 0x0
/* 00300C 8000600C 48001D79 */  bl        xlObjectMake
/* 003010 80006010 2C030000 */  cmpwi     r3, 0x0
/* 003014 80006014 4082000C */  bne       lbl_80006020
/* 003018 80006018 38600000 */  li        r3, 0x0
/* 00301C 8000601C 48000074 */  b         lbl_80006090
lbl_80006020:
/* 003020 80006020 818D88C0 */  lwz       r12, gpfOpen@sda21(r0)
/* 003024 80006024 280C0000 */  cmplwi    r12, 0x0
/* 003028 80006028 4182001C */  beq       lbl_80006044
/* 00302C 8000602C 809D0000 */  lwz       r4, 0x0(r29)
/* 003030 80006030 7D8803A6 */  mtlr      r12
/* 003034 80006034 387F0000 */  addi      r3, r31, 0x0
/* 003038 80006038 3884001C */  addi      r4, r4, 0x1c
/* 00303C 8000603C 4E800021 */  blrl
/* 003040 80006040 48000014 */  b         lbl_80006054
lbl_80006044:
/* 003044 80006044 809D0000 */  lwz       r4, 0x0(r29)
/* 003048 80006048 387F0000 */  addi      r3, r31, 0x0
/* 00304C 8000604C 3884001C */  addi      r4, r4, 0x1c
/* 003050 80006050 480AB829 */  bl        DVDOpen
lbl_80006054:
/* 003054 80006054 2C030000 */  cmpwi     r3, 0x0
/* 003058 80006058 4182002C */  beq       lbl_80006084
/* 00305C 8000605C 809D0000 */  lwz       r4, 0x0(r29)
/* 003060 80006060 38600001 */  li        r3, 0x1
/* 003064 80006064 93C40018 */  stw       r30, 0x18(r4)
/* 003068 80006068 809D0000 */  lwz       r4, 0x0(r29)
/* 00306C 8000606C 80040050 */  lwz       r0, 0x50(r4)
/* 003070 80006070 90040010 */  stw       r0, 0x10(r4)
/* 003074 80006074 809D0000 */  lwz       r4, 0x0(r29)
/* 003078 80006078 3804001C */  addi      r0, r4, 0x1c
/* 00307C 8000607C 90040004 */  stw       r0, 0x4(r4)
/* 003080 80006080 48000010 */  b         lbl_80006090
lbl_80006084:
/* 003084 80006084 7FA3EB78 */  mr        r3, r29
/* 003088 80006088 48001C65 */  bl        xlObjectFree
/* 00308C 8000608C 38600000 */  li        r3, 0x0
lbl_80006090:
/* 003090 80006090 8001002C */  lwz       r0, 0x2c(r1)
/* 003094 80006094 83E10024 */  lwz       r31, 0x24(r1)
/* 003098 80006098 83C10020 */  lwz       r30, 0x20(r1)
/* 00309C 8000609C 7C0803A6 */  mtlr      r0
/* 0030A0 800060A0 83A1001C */  lwz       r29, 0x1c(r1)
/* 0030A4 800060A4 38210028 */  addi      r1, r1, 0x28
/* 0030A8 800060A8 4E800020 */  blr

glabel xlFileGetSize
/* 0030AC 800060AC 7C0802A6 */  mflr      r0
/* 0030B0 800060B0 3CA0800E */  lis       r5, gTypeFile@ha
/* 0030B4 800060B4 90010004 */  stw       r0, 0x4(r1)
/* 0030B8 800060B8 38A5A3C0 */  addi      r5, r5, gTypeFile@l
/* 0030BC 800060BC 9421FFE0 */  stwu      r1, -0x20(r1)
/* 0030C0 800060C0 93E1001C */  stw       r31, 0x1c(r1)
/* 0030C4 800060C4 3BE30000 */  addi      r31, r3, 0x0
/* 0030C8 800060C8 38610010 */  addi      r3, r1, 0x10
/* 0030CC 800060CC 93C10018 */  stw       r30, 0x18(r1)
/* 0030D0 800060D0 3BC40000 */  addi      r30, r4, 0x0
/* 0030D4 800060D4 38800000 */  li        r4, 0x0
/* 0030D8 800060D8 48001CAD */  bl        xlObjectMake
/* 0030DC 800060DC 2C030000 */  cmpwi     r3, 0x0
/* 0030E0 800060E0 4082000C */  bne       lbl_800060EC
/* 0030E4 800060E4 38800000 */  li        r4, 0x0
/* 0030E8 800060E8 48000074 */  b         lbl_8000615C
lbl_800060EC:
/* 0030EC 800060EC 818D88C0 */  lwz       r12, gpfOpen@sda21(r0)
/* 0030F0 800060F0 280C0000 */  cmplwi    r12, 0x0
/* 0030F4 800060F4 4182001C */  beq       lbl_80006110
/* 0030F8 800060F8 80810010 */  lwz       r4, 0x10(r1)
/* 0030FC 800060FC 7D8803A6 */  mtlr      r12
/* 003100 80006100 387E0000 */  addi      r3, r30, 0x0
/* 003104 80006104 3884001C */  addi      r4, r4, 0x1c
/* 003108 80006108 4E800021 */  blrl
/* 00310C 8000610C 48000014 */  b         lbl_80006120
lbl_80006110:
/* 003110 80006110 80810010 */  lwz       r4, 0x10(r1)
/* 003114 80006114 387E0000 */  addi      r3, r30, 0x0
/* 003118 80006118 3884001C */  addi      r4, r4, 0x1c
/* 00311C 8000611C 480AB75D */  bl        DVDOpen
lbl_80006120:
/* 003120 80006120 2C030000 */  cmpwi     r3, 0x0
/* 003124 80006124 4182002C */  beq       lbl_80006150
/* 003128 80006128 80610010 */  lwz       r3, 0x10(r1)
/* 00312C 8000612C 38800001 */  li        r4, 0x1
/* 003130 80006130 90830018 */  stw       r4, 0x18(r3)
/* 003134 80006134 80610010 */  lwz       r3, 0x10(r1)
/* 003138 80006138 80030050 */  lwz       r0, 0x50(r3)
/* 00313C 8000613C 90030010 */  stw       r0, 0x10(r3)
/* 003140 80006140 80610010 */  lwz       r3, 0x10(r1)
/* 003144 80006144 3803001C */  addi      r0, r3, 0x1c
/* 003148 80006148 90030004 */  stw       r0, 0x4(r3)
/* 00314C 8000614C 48000010 */  b         lbl_8000615C
lbl_80006150:
/* 003150 80006150 38610010 */  addi      r3, r1, 0x10
/* 003154 80006154 48001B99 */  bl        xlObjectFree
/* 003158 80006158 38800000 */  li        r4, 0x0
lbl_8000615C:
/* 00315C 8000615C 2C040000 */  cmpwi     r4, 0x0
/* 003160 80006160 4182004C */  beq       lbl_800061AC
/* 003164 80006164 281F0000 */  cmplwi    r31, 0x0
/* 003168 80006168 41820010 */  beq       lbl_80006178
/* 00316C 8000616C 80610010 */  lwz       r3, 0x10(r1)
/* 003170 80006170 80030010 */  lwz       r0, 0x10(r3)
/* 003174 80006174 901F0000 */  stw       r0, 0x0(r31)
lbl_80006178:
/* 003178 80006178 38610010 */  addi      r3, r1, 0x10
/* 00317C 8000617C 48001B71 */  bl        xlObjectFree
/* 003180 80006180 2C030000 */  cmpwi     r3, 0x0
/* 003184 80006184 4082000C */  bne       lbl_80006190
/* 003188 80006188 38000000 */  li        r0, 0x0
/* 00318C 8000618C 48000008 */  b         lbl_80006194
lbl_80006190:
/* 003190 80006190 38000001 */  li        r0, 0x1
lbl_80006194:
/* 003194 80006194 2C000000 */  cmpwi     r0, 0x0
/* 003198 80006198 4082000C */  bne       lbl_800061A4
/* 00319C 8000619C 38600000 */  li        r3, 0x0
/* 0031A0 800061A0 48000010 */  b         lbl_800061B0
lbl_800061A4:
/* 0031A4 800061A4 38600001 */  li        r3, 0x1
/* 0031A8 800061A8 48000008 */  b         lbl_800061B0
lbl_800061AC:
/* 0031AC 800061AC 38600000 */  li        r3, 0x0
lbl_800061B0:
/* 0031B0 800061B0 80010024 */  lwz       r0, 0x24(r1)
/* 0031B4 800061B4 83E1001C */  lwz       r31, 0x1c(r1)
/* 0031B8 800061B8 83C10018 */  lwz       r30, 0x18(r1)
/* 0031BC 800061BC 7C0803A6 */  mtlr      r0
/* 0031C0 800061C0 38210020 */  addi      r1, r1, 0x20
/* 0031C4 800061C4 4E800020 */  blr

glabel xlFileSetRead
/* 0031C8 800061C8 906D88C4 */  stw       r3, gpfRead@sda21(r0)
/* 0031CC 800061CC 38600001 */  li        r3, 0x1
/* 0031D0 800061D0 4E800020 */  blr

glabel xlFileSetOpen
/* 0031D4 800061D4 906D88C0 */  stw       r3, gpfOpen@sda21(r0)
/* 0031D8 800061D8 38600001 */  li        r3, 0x1
/* 0031DC 800061DC 4E800020 */  blr

# 0x800DA3C0 - 0x800DA3E0
.section .data, "wa"

.balign 8

glabel gTypeFile
	.long D_8018AF80
	.long 0x00000058
	.long 0x00000000
	.long xlFileEvent
	.long 0x00000000
	.long 0x00000000
	.long 0x00000000
	.long 0x00000000

# 0x8018AF80 - 0x8018AF88
.section .sdata, "wa"

glabel D_8018AF80
	.string "FILE"

glabel gap_07_8018AF85_sdata
.hidden gap_07_8018AF85_sdata
	.byte 0x00, 0x00, 0x00

# 0x8018B840 - 0x8018B848
.section .sbss, "wa"

glabel gpfOpen
	.skip 0x4

glabel gpfRead
	.skip 0x4
