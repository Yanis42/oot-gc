# CARDCreate.c
.include "macros.inc"

.section .text, "ax"

.balign 4

CreateCallbackFat:
/* 0BADF8 800C0398 7C0802A6 */  mflr    r0
/* 0BADFC 800C039C 90010004 */  stw     r0, 4(r1)
/* 0BAE00 800C03A0 9421FFD8 */  stwu    r1, -0x28(r1)
/* 0BAE04 800C03A4 BF610014 */  stmw    r27, 0x14(r1)
/* 0BAE08 800C03A8 3B830000 */  addi    r28, r3, 0
/* 0BAE0C 800C03AC 3C608013 */  lis     r3, __CARDBlock@ha
/* 0BAE10 800C03B0 1CBC0110 */  mulli   r5, r28, 0x110
/* 0BAE14 800C03B4 380327D0 */  addi    r0, r3, __CARDBlock@l
/* 0BAE18 800C03B8 7FE02A14 */  add     r31, r0, r5
/* 0BAE1C 800C03BC 83BF00D0 */  lwz     r29, 0xd0(r31)
/* 0BAE20 800C03C0 3B600000 */  li      r27, 0
/* 0BAE24 800C03C4 7C9E2379 */  or.     r30, r4, r4
/* 0BAE28 800C03C8 937F00D0 */  stw     r27, 0xd0(r31)
/* 0BAE2C 800C03CC 418000C0 */  blt     lbl_800C048C
/* 0BAE30 800C03D0 7FE3FB78 */  mr      r3, r31
/* 0BAE34 800C03D4 4BFFD569 */  bl      __CARDGetDirBlock
/* 0BAE38 800C03D8 A01F00BC */  lhz     r0, 0xbc(r31)
/* 0BAE3C 800C03DC 38A00004 */  li      r5, 4
/* 0BAE40 800C03E0 809F010C */  lwz     r4, 0x10c(r31)
/* 0BAE44 800C03E4 54003032 */  slwi    r0, r0, 6
/* 0BAE48 800C03E8 7FC30214 */  add     r30, r3, r0
/* 0BAE4C 800C03EC 387E0000 */  addi    r3, r30, 0
/* 0BAE50 800C03F0 4BF450D5 */  bl      memcpy
/* 0BAE54 800C03F4 809F010C */  lwz     r4, 0x10c(r31)
/* 0BAE58 800C03F8 387E0004 */  addi    r3, r30, 4
/* 0BAE5C 800C03FC 38A00002 */  li      r5, 2
/* 0BAE60 800C0400 38840004 */  addi    r4, r4, 4
/* 0BAE64 800C0404 4BF450C1 */  bl      memcpy
/* 0BAE68 800C0408 38000004 */  li      r0, 4
/* 0BAE6C 800C040C 981E0034 */  stb     r0, 0x34(r30)
/* 0BAE70 800C0410 3800FFFF */  li      r0, -1
/* 0BAE74 800C0414 3C608000 */  lis     r3, 0x8000
/* 0BAE78 800C0418 9B7E0035 */  stb     r27, 0x35(r30)
/* 0BAE7C 800C041C A09F00BE */  lhz     r4, 0xbe(r31)
/* 0BAE80 800C0420 B09E0036 */  sth     r4, 0x36(r30)
/* 0BAE84 800C0424 9B7E0007 */  stb     r27, 7(r30)
/* 0BAE88 800C0428 901E002C */  stw     r0, 0x2c(r30)
/* 0BAE8C 800C042C B37E0030 */  sth     r27, 0x30(r30)
/* 0BAE90 800C0430 B37E0032 */  sth     r27, 0x32(r30)
/* 0BAE94 800C0434 901E003C */  stw     r0, 0x3c(r30)
/* 0BAE98 800C0438 A01E0032 */  lhz     r0, 0x32(r30)
/* 0BAE9C 800C043C 5400003A */  rlwinm  r0, r0, 0, 0, 0x1d
/* 0BAEA0 800C0440 60000001 */  ori     r0, r0, 1
/* 0BAEA4 800C0444 B01E0032 */  sth     r0, 0x32(r30)
/* 0BAEA8 800C0448 809F00C0 */  lwz     r4, 0xc0(r31)
/* 0BAEAC 800C044C 93640008 */  stw     r27, 8(r4)
/* 0BAEB0 800C0450 A01E0036 */  lhz     r0, 0x36(r30)
/* 0BAEB4 800C0454 809F00C0 */  lwz     r4, 0xc0(r31)
/* 0BAEB8 800C0458 B0040010 */  sth     r0, 0x10(r4)
/* 0BAEBC 800C045C 800300F8 */  lwz     r0, 0xf8(r3)
/* 0BAEC0 800C0460 541BF0BE */  srwi    r27, r0, 2
/* 0BAEC4 800C0464 4BFE1E45 */  bl      OSGetTime
/* 0BAEC8 800C0468 38DB0000 */  addi    r6, r27, 0
/* 0BAECC 800C046C 38A00000 */  li      r5, 0
/* 0BAED0 800C0470 4800D5AD */  bl      __div2i
/* 0BAED4 800C0474 909E0028 */  stw     r4, 0x28(r30)
/* 0BAED8 800C0478 387C0000 */  addi    r3, r28, 0
/* 0BAEDC 800C047C 389D0000 */  addi    r4, r29, 0
/* 0BAEE0 800C0480 4BFFD65D */  bl      __CARDUpdateDir
/* 0BAEE4 800C0484 7C7E1B79 */  or.     r30, r3, r3
/* 0BAEE8 800C0488 4080002C */  bge     lbl_800C04B4
lbl_800C048C:
/* 0BAEEC 800C048C 387F0000 */  addi    r3, r31, 0
/* 0BAEF0 800C0490 389E0000 */  addi    r4, r30, 0
/* 0BAEF4 800C0494 4BFFB8E1 */  bl      __CARDPutControlBlock
/* 0BAEF8 800C0498 281D0000 */  cmplwi  r29, 0
/* 0BAEFC 800C049C 41820018 */  beq     lbl_800C04B4
/* 0BAF00 800C04A0 399D0000 */  addi    r12, r29, 0
/* 0BAF04 800C04A4 7D8803A6 */  mtlr    r12
/* 0BAF08 800C04A8 387C0000 */  addi    r3, r28, 0
/* 0BAF0C 800C04AC 389E0000 */  addi    r4, r30, 0
/* 0BAF10 800C04B0 4E800021 */  blrl    
lbl_800C04B4:
/* 0BAF14 800C04B4 BB610014 */  lmw     r27, 0x14(r1)
/* 0BAF18 800C04B8 8001002C */  lwz     r0, 0x2c(r1)
/* 0BAF1C 800C04BC 38210028 */  addi    r1, r1, 0x28
/* 0BAF20 800C04C0 7C0803A6 */  mtlr    r0
/* 0BAF24 800C04C4 4E800020 */  blr     

glabel CARDCreateAsync
/* 0BAF28 800C04C8 7C0802A6 */  mflr    r0
/* 0BAF2C 800C04CC 90010004 */  stw     r0, 4(r1)
/* 0BAF30 800C04D0 9421FFB8 */  stwu    r1, -0x48(r1)
/* 0BAF34 800C04D4 BEE10024 */  stmw    r23, 0x24(r1)
/* 0BAF38 800C04D8 3B440000 */  addi    r26, r4, 0
/* 0BAF3C 800C04DC 3B230000 */  addi    r25, r3, 0
/* 0BAF40 800C04E0 3B650000 */  addi    r27, r5, 0
/* 0BAF44 800C04E4 3B860000 */  addi    r28, r6, 0
/* 0BAF48 800C04E8 3BA70000 */  addi    r29, r7, 0
/* 0BAF4C 800C04EC 387A0000 */  addi    r3, r26, 0
/* 0BAF50 800C04F0 4801056D */  bl      strlen
/* 0BAF54 800C04F4 28030020 */  cmplwi  r3, 0x20
/* 0BAF58 800C04F8 4081000C */  ble     lbl_800C0504
/* 0BAF5C 800C04FC 3860FFF4 */  li      r3, -12
/* 0BAF60 800C0500 480001D4 */  b       lbl_800C06D4
lbl_800C0504:
/* 0BAF64 800C0504 38790000 */  addi    r3, r25, 0
/* 0BAF68 800C0508 3881001C */  addi    r4, r1, 0x1c
/* 0BAF6C 800C050C 4BFFB7B1 */  bl      __CARDGetControlBlock
/* 0BAF70 800C0510 2C030000 */  cmpwi   r3, 0
/* 0BAF74 800C0514 40800008 */  bge     lbl_800C051C
/* 0BAF78 800C0518 480001BC */  b       lbl_800C06D4
lbl_800C051C:
/* 0BAF7C 800C051C 281B0000 */  cmplwi  r27, 0
/* 0BAF80 800C0520 4182001C */  beq     lbl_800C053C
/* 0BAF84 800C0524 8061001C */  lwz     r3, 0x1c(r1)
/* 0BAF88 800C0528 8083000C */  lwz     r4, 0xc(r3)
/* 0BAF8C 800C052C 7C1B2396 */  divwu   r0, r27, r4
/* 0BAF90 800C0530 7C0021D6 */  mullw   r0, r0, r4
/* 0BAF94 800C0534 7C00D851 */  subf.   r0, r0, r27
/* 0BAF98 800C0538 4182000C */  beq     lbl_800C0544
lbl_800C053C:
/* 0BAF9C 800C053C 3860FF80 */  li      r3, -128
/* 0BAFA0 800C0540 48000194 */  b       lbl_800C06D4
lbl_800C0544:
/* 0BAFA4 800C0544 3C800001 */  lis     r4, 1
/* 0BAFA8 800C0548 3BC4FFFF */  addi    r30, r4, -1
/* 0BAFAC 800C054C 4BFFD3F1 */  bl      __CARDGetDirBlock
/* 0BAFB0 800C0550 3BE30000 */  addi    r31, r3, 0
/* 0BAFB4 800C0554 3B1F0000 */  addi    r24, r31, 0
/* 0BAFB8 800C0558 3AE00000 */  li      r23, 0
/* 0BAFBC 800C055C 4800008C */  b       lbl_800C05E8
lbl_800C0560:
/* 0BAFC0 800C0560 88180000 */  lbz     r0, 0(r24)
/* 0BAFC4 800C0564 280000FF */  cmplwi  r0, 0xff
/* 0BAFC8 800C0568 40820018 */  bne     lbl_800C0580
/* 0BAFCC 800C056C 57C0043E */  clrlwi  r0, r30, 0x10
/* 0BAFD0 800C0570 2800FFFF */  cmplwi  r0, 0xffff
/* 0BAFD4 800C0574 4082006C */  bne     lbl_800C05E0
/* 0BAFD8 800C0578 7EFEBB78 */  mr      r30, r23
/* 0BAFDC 800C057C 48000064 */  b       lbl_800C05E0
lbl_800C0580:
/* 0BAFE0 800C0580 8081001C */  lwz     r4, 0x1c(r1)
/* 0BAFE4 800C0584 38780000 */  addi    r3, r24, 0
/* 0BAFE8 800C0588 38A00004 */  li      r5, 4
/* 0BAFEC 800C058C 8084010C */  lwz     r4, 0x10c(r4)
/* 0BAFF0 800C0590 4800E381 */  bl      memcmp
/* 0BAFF4 800C0594 2C030000 */  cmpwi   r3, 0
/* 0BAFF8 800C0598 40820048 */  bne     lbl_800C05E0
/* 0BAFFC 800C059C 8081001C */  lwz     r4, 0x1c(r1)
/* 0BB000 800C05A0 38780004 */  addi    r3, r24, 4
/* 0BB004 800C05A4 38A00002 */  li      r5, 2
/* 0BB008 800C05A8 8084010C */  lwz     r4, 0x10c(r4)
/* 0BB00C 800C05AC 38840004 */  addi    r4, r4, 4
/* 0BB010 800C05B0 4800E361 */  bl      memcmp
/* 0BB014 800C05B4 2C030000 */  cmpwi   r3, 0
/* 0BB018 800C05B8 40820028 */  bne     lbl_800C05E0
/* 0BB01C 800C05BC 38780000 */  addi    r3, r24, 0
/* 0BB020 800C05C0 389A0000 */  addi    r4, r26, 0
/* 0BB024 800C05C4 4BFFF7E9 */  bl      __CARDCompareFileName
/* 0BB028 800C05C8 2C030000 */  cmpwi   r3, 0
/* 0BB02C 800C05CC 41820014 */  beq     lbl_800C05E0
/* 0BB030 800C05D0 8061001C */  lwz     r3, 0x1c(r1)
/* 0BB034 800C05D4 3880FFF9 */  li      r4, -7
/* 0BB038 800C05D8 4BFFB79D */  bl      __CARDPutControlBlock
/* 0BB03C 800C05DC 480000F8 */  b       lbl_800C06D4
lbl_800C05E0:
/* 0BB040 800C05E0 3B180040 */  addi    r24, r24, 0x40
/* 0BB044 800C05E4 3AF70001 */  addi    r23, r23, 1
lbl_800C05E8:
/* 0BB048 800C05E8 56E0043E */  clrlwi  r0, r23, 0x10
/* 0BB04C 800C05EC 2800007F */  cmplwi  r0, 0x7f
/* 0BB050 800C05F0 4180FF70 */  blt     lbl_800C0560
/* 0BB054 800C05F4 57C0043E */  clrlwi  r0, r30, 0x10
/* 0BB058 800C05F8 2800FFFF */  cmplwi  r0, 0xffff
/* 0BB05C 800C05FC 40820014 */  bne     lbl_800C0610
/* 0BB060 800C0600 8061001C */  lwz     r3, 0x1c(r1)
/* 0BB064 800C0604 3880FFF8 */  li      r4, -8
/* 0BB068 800C0608 4BFFB76D */  bl      __CARDPutControlBlock
/* 0BB06C 800C060C 480000C8 */  b       lbl_800C06D4
lbl_800C0610:
/* 0BB070 800C0610 8061001C */  lwz     r3, 0x1c(r1)
/* 0BB074 800C0614 4BFFCF25 */  bl      __CARDGetFatBlock
/* 0BB078 800C0618 8081001C */  lwz     r4, 0x1c(r1)
/* 0BB07C 800C061C A0030006 */  lhz     r0, 6(r3)
/* 0BB080 800C0620 8064000C */  lwz     r3, 0xc(r4)
/* 0BB084 800C0624 7C0301D6 */  mullw   r0, r3, r0
/* 0BB088 800C0628 7C00D840 */  cmplw   r0, r27
/* 0BB08C 800C062C 40800014 */  bge     lbl_800C0640
/* 0BB090 800C0630 38640000 */  addi    r3, r4, 0
/* 0BB094 800C0634 3880FFF7 */  li      r4, -9
/* 0BB098 800C0638 4BFFB73D */  bl      __CARDPutControlBlock
/* 0BB09C 800C063C 48000098 */  b       lbl_800C06D4
lbl_800C0640:
/* 0BB0A0 800C0640 281D0000 */  cmplwi  r29, 0
/* 0BB0A4 800C0644 4182000C */  beq     lbl_800C0650
/* 0BB0A8 800C0648 7FA0EB78 */  mr      r0, r29
/* 0BB0AC 800C064C 4800000C */  b       lbl_800C0658
lbl_800C0650:
/* 0BB0B0 800C0650 3C60800C */  lis     r3, __CARDDefaultApiCallback@ha
/* 0BB0B4 800C0654 3803AD5C */  addi    r0, r3, __CARDDefaultApiCallback@l
lbl_800C0658:
/* 0BB0B8 800C0658 900400D0 */  stw     r0, 0xd0(r4)
/* 0BB0BC 800C065C 57C032B2 */  rlwinm  r0, r30, 6, 0xa, 0x19
/* 0BB0C0 800C0660 7CFF0214 */  add     r7, r31, r0
/* 0BB0C4 800C0664 8061001C */  lwz     r3, 0x1c(r1)
/* 0BB0C8 800C0668 57DD043E */  clrlwi  r29, r30, 0x10
/* 0BB0CC 800C066C 389A0000 */  addi    r4, r26, 0
/* 0BB0D0 800C0670 B3C300BC */  sth     r30, 0xbc(r3)
/* 0BB0D4 800C0674 38670008 */  addi    r3, r7, 8
/* 0BB0D8 800C0678 38A00020 */  li      r5, 0x20
/* 0BB0DC 800C067C 80C1001C */  lwz     r6, 0x1c(r1)
/* 0BB0E0 800C0680 8006000C */  lwz     r0, 0xc(r6)
/* 0BB0E4 800C0684 7C1B0396 */  divwu   r0, r27, r0
/* 0BB0E8 800C0688 B0070038 */  sth     r0, 0x38(r7)
/* 0BB0EC 800C068C 480102D9 */  bl      strncpy
/* 0BB0F0 800C0690 8081001C */  lwz     r4, 0x1c(r1)
/* 0BB0F4 800C0694 3C60800C */  lis     r3, CreateCallbackFat@ha
/* 0BB0F8 800C0698 38A30398 */  addi    r5, r3, CreateCallbackFat@l
/* 0BB0FC 800C069C 938400C0 */  stw     r28, 0xc0(r4)
/* 0BB100 800C06A0 7F23CB78 */  mr      r3, r25
/* 0BB104 800C06A4 933C0000 */  stw     r25, 0(r28)
/* 0BB108 800C06A8 93BC0004 */  stw     r29, 4(r28)
/* 0BB10C 800C06AC 8081001C */  lwz     r4, 0x1c(r1)
/* 0BB110 800C06B0 8004000C */  lwz     r0, 0xc(r4)
/* 0BB114 800C06B4 7C9B0396 */  divwu   r4, r27, r0
/* 0BB118 800C06B8 4BFFD025 */  bl      __CARDAllocBlock
/* 0BB11C 800C06BC 7C641B79 */  or.     r4, r3, r3
/* 0BB120 800C06C0 40800010 */  bge     lbl_800C06D0
/* 0BB124 800C06C4 8061001C */  lwz     r3, 0x1c(r1)
/* 0BB128 800C06C8 4BFFB6AD */  bl      __CARDPutControlBlock
/* 0BB12C 800C06CC 48000008 */  b       lbl_800C06D4
lbl_800C06D0:
/* 0BB130 800C06D0 7C832378 */  mr      r3, r4
lbl_800C06D4:
/* 0BB134 800C06D4 BAE10024 */  lmw     r23, 0x24(r1)
/* 0BB138 800C06D8 8001004C */  lwz     r0, 0x4c(r1)
/* 0BB13C 800C06DC 38210048 */  addi    r1, r1, 0x48
/* 0BB140 800C06E0 7C0803A6 */  mtlr    r0
/* 0BB144 800C06E4 4E800020 */  blr     
